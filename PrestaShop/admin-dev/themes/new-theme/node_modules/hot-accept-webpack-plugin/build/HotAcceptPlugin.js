"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.HotAcceptPlugin = void 0;
const modify_source_webpack_plugin_1 = require("modify-source-webpack-plugin");
function createRule(test, modify) {
    if (typeof test === 'string') {
        const testString = test.replace(/\\/g, '/');
        const testFn = (module) => {
            const moduleRequest = module.userRequest?.replace(/\\/g, '/');
            return moduleRequest ? moduleRequest.endsWith(testString) : false;
        };
        return {
            test: testFn,
            modify
        };
    }
    return {
        test,
        modify
    };
}
class HotAcceptPlugin extends modify_source_webpack_plugin_1.ModifySourcePlugin {
    constructor(options) {
        const modify = (src) => src + 'if (module.hot) { module.hot.accept(); }';
        const parentOptions = {
            rules: Array.isArray(options.test)
                ? options.test.map(test => createRule(test, modify))
                : [createRule(options.test, modify)],
            debug: options.debug
        };
        super(parentOptions);
    }
}
exports.HotAcceptPlugin = HotAcceptPlugin;
//# sourceMappingURL=HotAcceptPlugin.js.map